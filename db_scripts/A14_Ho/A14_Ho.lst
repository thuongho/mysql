--------------
-- Thuong Ho
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
    /* enable warnings! */

use a_bkorders
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
/*  TASK 00 */ 
select user(), current_date(), version(), @@sql_mode
--------------

*************************** 1. row ***************************
        user(): t_ho@localhost
current_date(): 2013-12-09
     version(): 5.6.13
    @@sql_mode: STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION
1 row in set (0.00 sec)

--------------
/*  TASK 01 */
Select order_date as OrderDate
, Count(OrdHeaders.order_id) as NumberOrders
, sum(quantity * order_price) as AmntDue
, sum(quantity) as NumbBooksPurch
From a_bkorders.order_headers as OrdHeaders
Join a_bkorders.order_details as OrdDetails on OrdHeaders.order_id = OrdDetails.order_id
Group by OrderDate with Rollup
--------------

+------------+--------------+-----------+----------------+
| OrderDate  | NumberOrders | AmntDue   | NumbBooksPurch |
+------------+--------------+-----------+----------------+
| 2011-07-02 |            3 |   1305.49 |             52 |
| 2011-07-18 |            4 |    578.59 |             16 |
| 2011-09-22 |            6 |    901.30 |             28 |
| 2011-09-25 |            3 |    649.95 |             15 |
| 2011-09-28 |            3 |    600.40 |             16 |
| 2011-09-29 |            2 |    135.95 |              6 |
| 2011-10-02 |            1 |     58.00 |              1 |
| 2011-10-23 |            2 |    859.50 |             20 |
| 2011-10-28 |            6 |  10307.45 |            262 |
| 2012-01-11 |            2 |    137.45 |              4 |
| 2012-01-12 |            7 |   3273.93 |            115 |
| 2012-01-18 |            3 |   2585.50 |             90 |
| 2012-01-25 |            2 |   1625.00 |            145 |
| 2012-01-26 |            1 |   2450.00 |             50 |
| 2012-01-27 |            2 |   6794.00 |            149 |
| 2012-02-02 |            1 |     58.00 |              1 |
| 2012-02-04 |            2 |   2454.26 |            454 |
| 2012-02-12 |            2 |   6900.00 |            300 |
| 2012-02-15 |            1 |    276.00 |             23 |
| 2012-02-16 |            1 |   3875.00 |            155 |
| 2012-02-18 |            3 |    564.95 |             12 |
| 2012-02-22 |            3 |    308.70 |              7 |
| 2012-02-28 |            4 |    299.70 |              8 |
| 2012-03-06 |            1 |   1250.00 |             50 |
| 2012-03-10 |            2 |   1271.90 |             52 |
| 2012-03-12 |            1 |    499.50 |             10 |
| 2012-04-02 |            1 |   1250.00 |             50 |
| 2012-04-05 |            2 |   1300.00 |             30 |
| 2012-04-12 |            4 |    464.70 |             28 |
| 2012-04-13 |            2 |     50.90 |              3 |
| 2012-04-14 |            1 |   1250.00 |             50 |
| 2012-04-17 |            1 |     49.95 |              1 |
| 2012-04-18 |            3 |   4745.00 |            150 |
| 2012-04-21 |            1 |    181.96 |              4 |
| 2012-04-24 |            1 |    560.00 |             16 |
| 2012-05-08 |            1 |   4503.51 |             99 |
| 2012-05-09 |            2 |   3015.99 |            100 |
| 2012-05-12 |            4 |    198.85 |              7 |
| 2012-05-15 |            1 |     45.99 |              1 |
| 2012-05-16 |            4 |    750.98 |             34 |
| 2012-05-17 |            1 |    273.75 |             25 |
| 2012-05-20 |            1 |     25.00 |              2 |
| 2012-05-22 |            1 |     35.00 |              1 |
| 2012-05-30 |            1 |   1250.00 |             50 |
| 2012-06-20 |            1 |     24.00 |              2 |
| 2012-06-21 |            1 |     25.00 |              2 |
| 2012-06-22 |            3 |   2525.00 |            102 |
| 2012-07-01 |            1 |     24.00 |              2 |
| 2012-07-02 |            2 |   1290.49 |             51 |
| 2012-07-18 |            9 |   1419.89 |             41 |
| 2012-07-20 |            3 |     83.63 |              3 |
| 2012-08-02 |            2 |    999.00 |             30 |
| 2012-08-05 |            1 |     40.49 |              1 |
| 2012-08-08 |            4 |    551.01 |             12 |
| 2012-08-15 |            1 |     40.49 |              1 |
| 2012-09-01 |            1 |    165.00 |             11 |
| 2012-09-02 |            3 |   2107.45 |             45 |
| 2012-09-03 |            1 |   1250.00 |             50 |
| 2012-09-04 |            2 |   2749.50 |            100 |
| 2012-09-05 |            2 |    124.95 |              6 |
| 2012-09-06 |            2 |   1475.60 |             10 |
| 2012-09-08 |            3 |    806.00 |             28 |
| 2012-09-10 |            9 |   4308.40 |            154 |
| 2012-09-14 |            5 |    525.40 |             18 |
| 2012-09-15 |            3 |    103.19 |              5 |
| 2012-09-18 |            6 |   1455.24 |             48 |
| 2012-09-20 |            4 |    996.68 |             25 |
| 2012-09-22 |           10 |   2726.29 |             88 |
| 2012-09-23 |            2 |     59.99 |              2 |
| 2012-09-24 |            1 |     45.00 |              1 |
| 2012-09-25 |            3 |    649.95 |             15 |
| 2012-09-28 |            5 |  22220.38 |            578 |
| 2012-09-29 |            2 |   2500.00 |            100 |
| 2012-09-30 |           12 |   3325.26 |            114 |
| 2012-10-03 |            5 |   3150.80 |            106 |
| 2012-10-06 |           15 |  23016.30 |            555 |
| 2012-10-11 |            2 |    137.45 |              4 |
| 2012-11-02 |            2 |    213.75 |              6 |
| 2012-11-11 |            2 |    137.45 |              4 |
| 2012-11-28 |            3 |   9742.50 |            250 |
| 2012-11-29 |            2 |   2047.80 |             30 |
| 2012-11-30 |            2 |   5355.30 |            110 |
| 2012-12-02 |            1 |     58.00 |              1 |
| 2012-12-03 |            8 |  29504.13 |            906 |
| 2012-12-04 |            5 |    573.15 |             27 |
| 2012-12-07 |            1 |    700.00 |             35 |
| 2012-12-11 |            2 |    137.45 |              4 |
| 2012-12-12 |            4 |    223.93 |              5 |
| 2013-01-18 |            3 |    564.95 |             12 |
| 2013-01-22 |            3 |    308.70 |              7 |
| 2013-01-25 |            2 |   1625.00 |            145 |
| 2013-01-26 |            1 |   2450.00 |             50 |
| 2013-01-28 |            4 |    299.70 |              8 |
| 2013-02-12 |            5 |    225.84 |              8 |
| 2013-02-15 |            3 |    367.98 |             25 |
| 2013-02-20 |            1 |     25.00 |              2 |
| 2013-03-01 |            1 |     24.00 |              2 |
| 2013-03-02 |            2 |   1290.49 |             51 |
| 2013-03-03 |            1 |   1250.00 |             50 |
| 2013-03-04 |            2 |    180.00 |              6 |
| 2013-03-08 |            5 |   1288.01 |             37 |
| 2013-03-12 |            8 |    398.32 |             10 |
| 2013-03-13 |            4 |    103.90 |              4 |
| 2013-03-20 |            2 |   6794.00 |            149 |
| 2013-03-21 |            2 |    519.50 |             20 |
| 2013-03-22 |            2 |    394.95 |              6 |
| 2013-03-23 |            3 |    649.00 |             12 |
| 2013-03-24 |            2 |     61.89 |              3 |
| 2013-03-25 |            1 |    180.00 |              2 |
| 2013-03-26 |            3 |     55.95 |              3 |
| 2013-04-02 |            2 |    999.00 |             30 |
| 2013-04-05 |            1 |     40.49 |              1 |
| 2013-04-08 |            2 |     69.00 |              3 |
| 2013-04-15 |            1 |     40.49 |              1 |
| 2013-05-01 |            1 |    165.00 |             11 |
| 2013-05-02 |            3 |   2107.45 |             45 |
| 2013-05-04 |            2 |   2749.50 |            100 |
| 2013-05-05 |            2 |     64.95 |              2 |
| 2013-05-06 |            2 |   1295.60 |              8 |
| 2013-05-24 |            1 |     75.00 |              5 |
| 2013-05-26 |            2 |   1475.60 |             10 |
| 2013-06-02 |            2 |    213.75 |              6 |
| 2013-06-04 |            3 |    287.75 |             14 |
| 2013-06-05 |            1 |     44.99 |              1 |
| 2013-06-09 |            3 |    100.49 |              3 |
| 2013-06-29 |            2 |   2047.80 |             30 |
| 2013-06-30 |            2 |   5355.30 |            110 |
| 2013-07-01 |            1 |     24.00 |              2 |
| 2013-07-02 |            2 |   1290.49 |             51 |
| 2013-07-18 |            4 |    402.64 |             16 |
| 2013-07-20 |            2 |     56.34 |              2 |
| 2013-08-08 |            5 |   1296.01 |             31 |
| 2013-08-12 |            5 |    148.94 |              5 |
| 2013-08-25 |            1 |   2525.00 |            100 |
| 2013-08-26 |            5 |    411.55 |             26 |
| 2013-08-28 |            2 |     46.78 |              4 |
| 2013-09-01 |            5 |   1277.25 |             41 |
| 2013-09-08 |           14 |   1114.43 |             46 |
| 2013-10-01 |            2 |    177.97 |              3 |
| 2013-10-02 |            1 |    480.72 |              4 |
| 2013-10-03 |            4 |  12930.75 |            391 |
| 2013-10-04 |            2 |     38.89 |              3 |
| 2013-10-05 |            1 |    888.00 |             50 |
| 2013-10-08 |            2 |   2138.00 |            100 |
| NULL       |          408 | 261024.49 |           8247 |
+------------+--------------+-----------+----------------+
145 rows in set (0.01 sec)

--------------
/*  TASK 02 */
Select year(order_date) as Year
, month(order_date) as Month
, OrdHeaders.order_id as Order_ID 
, sum(quantity * order_price) as AmntDue
, sum(quantity) as NumbBooksPurch
From a_bkorders.order_headers as OrdHeaders
Join a_bkorders.order_details as OrdDetails on OrdHeaders.order_id = OrdDetails.order_id
Group by Year, Month, OrdHeaders.order_id with Rollup
--------------

+------+-------+----------+-----------+----------------+
| Year | Month | Order_ID | AmntDue   | NumbBooksPurch |
+------+-------+----------+-----------+----------------+
| 2011 |     7 |     2045 |     35.99 |              1 |
| 2011 |     7 |     2200 |    542.60 |             15 |
| 2011 |     7 |    21841 |   1250.00 |             50 |
| 2011 |     7 |    21850 |     55.49 |              2 |
| 2011 |     7 |     NULL |   1884.08 |             68 |
| 2011 |     9 |    22909 |    225.00 |              5 |
| 2011 |     9 |    22910 |    424.95 |             10 |
| 2011 |     9 |    32997 |    841.30 |             25 |
| 2011 |     9 |    32998 |     60.00 |              3 |
| 2011 |     9 |    41005 |    170.90 |              6 |
| 2011 |     9 |    41006 |    429.50 |             10 |
| 2011 |     9 |    42899 |    135.95 |              6 |
| 2011 |     9 |     NULL |   2287.60 |             65 |
| 2011 |    10 |    21254 |    859.50 |             20 |
| 2011 |    10 |    21255 |    564.95 |             12 |
| 2011 |    10 |    21261 |   9742.50 |            250 |
| 2011 |    10 |    32905 |     58.00 |              1 |
| 2011 |    10 |     NULL |  11224.95 |            283 |
| 2011 |  NULL |     NULL |  15396.63 |            416 |
| 2012 |     1 |    21411 |   1250.00 |             50 |
| 2012 |     1 |    21420 |   1800.00 |             60 |
| 2012 |     1 |    21442 |   2585.50 |             90 |
| 2012 |     1 |    21483 |    137.45 |              4 |
| 2012 |     1 |    21491 |    123.95 |              3 |
| 2012 |     1 |    21552 |     99.98 |              2 |
| 2012 |     1 |    32900 |   1625.00 |            145 |
| 2012 |     1 |    32901 |   2450.00 |             50 |
| 2012 |     1 |    32902 |   6794.00 |            149 |
| 2012 |     1 |     NULL |  16865.88 |            553 |
| 2012 |     2 |     1553 |   6900.00 |            300 |
| 2012 |     2 |     1555 |    564.95 |             12 |
| 2012 |     2 |     1561 |    308.70 |              7 |
| 2012 |     2 |     1562 |    299.70 |              8 |
| 2012 |     2 |    30814 |    276.00 |             23 |
| 2012 |     2 |    30815 |   3875.00 |            155 |
| 2012 |     2 |    32903 |     58.00 |              1 |
| 2012 |     2 |    32904 |   2454.26 |            454 |
| 2012 |     2 |     NULL |  14736.61 |            960 |
| 2012 |     3 |    30816 |   1250.00 |             50 |
| 2012 |     3 |    30820 |   1250.00 |             50 |
| 2012 |     3 |    30821 |     21.90 |              2 |
| 2012 |     3 |    30822 |    499.50 |             10 |
| 2012 |     3 |     NULL |   3021.40 |            112 |
| 2012 |     4 |     1564 |   4745.00 |            150 |
| 2012 |     4 |     1800 |    221.70 |              6 |
| 2012 |     4 |     1801 |     50.90 |              3 |
| 2012 |     4 |     2001 |   1250.00 |             50 |
| 2012 |     4 |     2002 |    219.00 |             20 |
| 2012 |     4 |     2003 |     24.00 |              2 |
| 2012 |     4 |    30824 |   1300.00 |             30 |
| 2012 |     4 |    30825 |    181.96 |              4 |
| 2012 |     4 |    30826 |    560.00 |             16 |
| 2012 |     4 |    30833 |   1250.00 |             50 |
| 2012 |     4 |    30834 |     49.95 |              1 |
| 2012 |     4 |     NULL |   9852.51 |            332 |
| 2012 |     5 |     1710 |   4503.51 |             99 |
| 2012 |     5 |     1712 |   3015.99 |            100 |
| 2012 |     5 |     1811 |    171.86 |              6 |
| 2012 |     5 |     1812 |     26.99 |              1 |
| 2012 |     5 |     1814 |     45.99 |              1 |
| 2012 |     5 |     1818 |    750.98 |             34 |
| 2012 |     5 |     2004 |     35.00 |              1 |
| 2012 |     5 |     2005 |   1250.00 |             50 |
| 2012 |     5 |    30835 |    273.75 |             25 |
| 2012 |     5 |    30836 |     25.00 |              2 |
| 2012 |     5 |     NULL |  10099.07 |            319 |
| 2012 |     6 |     2012 |   1250.00 |             50 |
| 2012 |     6 |     2013 |     25.00 |              2 |
| 2012 |     6 |    30847 |     24.00 |              2 |
| 2012 |     6 |    30848 |     25.00 |              2 |
| 2012 |     6 |    30849 |   1250.00 |             50 |
| 2012 |     6 |     NULL |   2574.00 |            106 |
| 2012 |     7 |     1045 |     35.99 |              1 |
| 2012 |     7 |     1200 |   1383.90 |             40 |
| 2012 |     7 |     1205 |     27.29 |              1 |
| 2012 |     7 |     1212 |     56.34 |              2 |
| 2012 |     7 |    31840 |     24.00 |              2 |
| 2012 |     7 |    31841 |   1250.00 |             50 |
| 2012 |     7 |    31850 |     40.49 |              1 |
| 2012 |     7 |     NULL |   2818.01 |             97 |
| 2012 |     8 |     1224 |    441.52 |              8 |
| 2012 |     8 |     1253 |     69.00 |              3 |
| 2012 |     8 |    31852 |     40.49 |              1 |
| 2012 |     8 |    31853 |    999.00 |             30 |
| 2012 |     8 |    31855 |     40.49 |              1 |
| 2012 |     8 |    31860 |     40.49 |              1 |
| 2012 |     8 |     NULL |   1630.99 |             44 |
| 2012 |     9 |     1002 |    581.00 |             23 |
| 2012 |     9 |     1003 |    225.00 |              5 |
| 2012 |     9 |     1004 |     36.50 |              2 |
| 2012 |     9 |     1005 |    170.90 |              6 |
| 2012 |     9 |     1006 |    109.50 |             10 |
| 2012 |     9 |     1007 |   1250.00 |             50 |
| 2012 |     9 |     1008 |   2000.00 |             50 |
| 2012 |     9 |     1010 |   1250.00 |             50 |
| 2012 |     9 |     1011 |     21.90 |              2 |
| 2012 |     9 |     1012 |     49.95 |              1 |
| 2012 |     9 |     1027 |   1291.57 |             43 |
| 2012 |     9 |     1028 |    996.68 |             25 |
| 2012 |     9 |     1030 |     40.49 |              1 |
| 2012 |     9 |     1035 |     55.19 |              1 |
| 2012 |     9 |     1039 |     99.90 |              3 |
| 2012 |     9 |     1040 |  21939.98 |            562 |
| 2012 |     9 |     1602 |     50.90 |              3 |
| 2012 |     9 |     1603 |    252.75 |              7 |
| 2012 |     9 |     1604 |    708.75 |             40 |
| 2012 |     9 |     1606 |    474.50 |             15 |
| 2012 |     9 |     1610 |     24.00 |              2 |
| 2012 |     9 |     1615 |     24.00 |              2 |
| 2012 |     9 |    22803 |   2107.45 |             45 |
| 2012 |     9 |    22804 |   2749.50 |            100 |
| 2012 |     9 |    22805 |   1475.60 |             10 |
| 2012 |     9 |    22806 |     25.00 |              1 |
| 2012 |     9 |    22807 |     34.99 |              1 |
| 2012 |     9 |    22808 |     45.00 |              1 |
| 2012 |     9 |    22809 |    225.00 |              5 |
| 2012 |     9 |    22810 |    424.95 |             10 |
| 2012 |     9 |    22811 |    225.00 |              5 |
| 2012 |     9 |    22812 |   2704.50 |            100 |
| 2012 |     9 |    22813 |    395.76 |              9 |
| 2012 |     9 |    31884 |    209.91 |             10 |
| 2012 |     9 |    31885 |   1250.00 |             50 |
| 2012 |     9 |    31889 |    910.80 |             18 |
| 2012 |     9 |    32800 |   1250.00 |             50 |
| 2012 |     9 |    32890 |    165.00 |             11 |
| 2012 |     9 |    32891 |     75.00 |              5 |
| 2012 |     9 |    32892 |     75.00 |              5 |
| 2012 |     9 |    32893 |     55.19 |              1 |
| 2012 |     9 |    32894 |     35.99 |              1 |
| 2012 |     9 |    32895 |     55.19 |              1 |
| 2012 |     9 |    32896 |     35.99 |              1 |
| 2012 |     9 |    32897 |    100.00 |              2 |
| 2012 |     9 |    32898 |     60.00 |              3 |
| 2012 |     9 |    32899 |   1250.00 |             50 |
| 2012 |     9 |     NULL |  47594.28 |           1398 |
| 2012 |    10 |     1563 |     50.90 |              3 |
| 2012 |    10 |     1601 |    800.30 |             21 |
| 2012 |    10 |     1605 |   1057.00 |             32 |
| 2012 |    10 |     1702 |    100.00 |              2 |
| 2012 |    10 |     1705 |  21059.00 |            500 |
| 2012 |    10 |    14873 |    137.45 |              4 |
| 2012 |    10 |    31871 |     99.90 |              3 |
| 2012 |    10 |    31872 |   3000.00 |            100 |
| 2012 |    10 |     NULL |  26304.55 |            665 |
| 2012 |    11 |     5261 |   9742.50 |            250 |
| 2012 |    11 |     5262 |    213.75 |              6 |
| 2012 |    11 |     5321 |   2047.80 |             30 |
| 2012 |    11 |     5328 |   3149.30 |             70 |
| 2012 |    11 |     5345 |   2206.00 |             40 |
| 2012 |    11 |    54883 |    137.45 |              4 |
| 2012 |    11 |     NULL |  17496.80 |            400 |
| 2012 |    12 |     1346 |  29267.00 |            900 |
| 2012 |    12 |     1347 |    237.13 |              6 |
| 2012 |    12 |     1410 |    700.00 |             35 |
| 2012 |    12 |     5483 |    137.45 |              4 |
| 2012 |    12 |     5491 |    123.95 |              3 |
| 2012 |    12 |     5552 |     99.98 |              2 |
| 2012 |    12 |    32907 |    285.40 |             13 |
| 2012 |    12 |    52905 |     58.00 |              1 |
| 2012 |    12 |    52906 |    287.75 |             14 |
| 2012 |    12 |     NULL |  31196.66 |            978 |
| 2012 |  NULL |     NULL | 184190.76 |           5964 |
| 2013 |     1 |     5555 |    564.95 |             12 |
| 2013 |     1 |     5561 |    308.70 |              7 |
| 2013 |     1 |     5562 |    299.70 |              8 |
| 2013 |     1 |    52900 |   1625.00 |            145 |
| 2013 |     1 |    52901 |   2450.00 |             50 |
| 2013 |     1 |     NULL |   5248.35 |            222 |
| 2013 |     2 |    18142 |     26.99 |              1 |
| 2013 |     2 |    18144 |     45.99 |              1 |
| 2013 |     2 |    40814 |    276.00 |             23 |
| 2013 |     2 |    40836 |     25.00 |              2 |
| 2013 |     2 |    41811 |    171.86 |              6 |
| 2013 |     2 |    41812 |     26.99 |              1 |
| 2013 |     2 |    41814 |     45.99 |              1 |
| 2013 |     2 |     NULL |    618.82 |             35 |
| 2013 |     3 |     4002 |    581.00 |             23 |
| 2013 |     3 |     4003 |    225.00 |              5 |
| 2013 |     3 |     4007 |   1250.00 |             50 |
| 2013 |     3 |    33001 |    180.00 |              6 |
| 2013 |     3 |    33002 |    237.13 |              6 |
| 2013 |     3 |    33005 |     51.95 |              2 |
| 2013 |     3 |    33006 |     51.95 |              2 |
| 2013 |     3 |    33007 |    161.19 |              4 |
| 2013 |     3 |    33008 |    189.00 |              7 |
| 2013 |     3 |    33009 |    195.00 |              5 |
| 2013 |     3 |    33013 |   6794.00 |            149 |
| 2013 |     3 |    33014 |    519.50 |             20 |
| 2013 |     3 |    33017 |      4.00 |              1 |
| 2013 |     3 |    33022 |    199.95 |              1 |
| 2013 |     3 |    33023 |    460.00 |              5 |
| 2013 |     3 |    33034 |     61.89 |              3 |
| 2013 |     3 |    33035 |    180.00 |              2 |
| 2013 |     3 |    33040 |     51.95 |              2 |
| 2013 |     3 |    41224 |    441.52 |              8 |
| 2013 |     3 |    41840 |     24.00 |              2 |
| 2013 |     3 |    41841 |   1250.00 |             50 |
| 2013 |     3 |    41850 |     40.49 |              1 |
| 2013 |     3 |    41852 |     40.49 |              1 |
| 2013 |     3 |     NULL |  13190.01 |            355 |
| 2013 |     4 |     1256 |     69.00 |              3 |
| 2013 |     4 |    31455 |     40.49 |              1 |
| 2013 |     4 |    31560 |     40.49 |              1 |
| 2013 |     4 |    41853 |    999.00 |             30 |
| 2013 |     4 |     NULL |   1148.98 |             35 |
| 2013 |     5 |    10812 |     49.95 |              1 |
| 2013 |     5 |    22774 |   2749.50 |            100 |
| 2013 |     5 |    23890 |    165.00 |             11 |
| 2013 |     5 |    24345 |   1475.60 |             10 |
| 2013 |     5 |    24802 |   1295.60 |              8 |
| 2013 |     5 |    25803 |   2107.45 |             45 |
| 2013 |     5 |    42331 |     75.00 |              5 |
| 2013 |     5 |    42891 |     15.00 |              1 |
| 2013 |     5 |     NULL |   7933.10 |            181 |
| 2013 |     6 |     1262 |    213.75 |              6 |
| 2013 |     6 |     1302 |     44.99 |              1 |
| 2013 |     6 |     1310 |    100.49 |              3 |
| 2013 |     6 |     1321 |   2047.80 |             30 |
| 2013 |     6 |     1328 |   3149.30 |             70 |
| 2013 |     6 |     1345 |   2206.00 |             40 |
| 2013 |     6 |    32906 |    287.75 |             14 |
| 2013 |     6 |     NULL |   8050.08 |            164 |
| 2013 |     7 |    51840 |     24.00 |              2 |
| 2013 |     7 |    51841 |   1290.49 |             51 |
| 2013 |     7 |    51842 |    402.64 |             16 |
| 2013 |     7 |    51843 |     56.34 |              2 |
| 2013 |     7 |     NULL |   1773.47 |             71 |
| 2013 |     8 |    51833 |   1226.01 |             30 |
| 2013 |     8 |    51850 |     70.00 |              1 |
| 2013 |     8 |    51851 |    148.94 |              3 |
| 2013 |     8 |    51852 |      0.00 |              2 |
| 2013 |     8 |    51853 |   2525.00 |            100 |
| 2013 |     8 |    51854 |    230.55 |             15 |
| 2013 |     8 |    51855 |    181.00 |             11 |
| 2013 |     8 |    51856 |     46.78 |              4 |
| 2013 |     8 |     NULL |   4428.28 |            166 |
| 2013 |     9 |    51845 |   1277.25 |             41 |
| 2013 |     9 |    51846 |    642.68 |             32 |
| 2013 |     9 |    51857 |    185.12 |              5 |
| 2013 |     9 |    51858 |    116.70 |              6 |
| 2013 |     9 |    51859 |    113.94 |              2 |
| 2013 |     9 |    51860 |     55.99 |              1 |
| 2013 |     9 |     NULL |   2391.68 |             87 |
| 2013 |    10 |    51847 |     38.89 |              3 |
| 2013 |    10 |    51848 |    888.00 |             50 |
| 2013 |    10 |    51849 |   2138.00 |            100 |
| 2013 |    10 |    51861 |    177.97 |              3 |
| 2013 |    10 |    51862 |    480.72 |              4 |
| 2013 |    10 |    51863 |    837.90 |             42 |
| 2013 |    10 |    51864 |  12092.85 |            349 |
| 2013 |    10 |     NULL |  16654.33 |            551 |
| 2013 |  NULL |     NULL |  61437.10 |           1867 |
| NULL |  NULL |     NULL | 261024.49 |           8247 |
+------+-------+----------+-----------+----------------+
253 rows in set (0.00 sec)

--------------
/*  TASK 03 */
-- format 2
Select coalesce(OrdYr, 'Grand Total') as Year
, case when OrdYr is null then '..........' else coalesce(OrdM, 'Year Total') end as Month
, case when OrdM is null then '...........' else coalesce(order_id, 'Month Total') end as Order_ID 
, AmntDue
, NumbBooksPurch
From (
	Select year(order_date) as OrdYr
	, month(order_date) as OrdM
	, order_id
	, sum(quantity * order_price) as AmntDue
	, sum(quantity) as NumbBooksPurch
	From a_bkorders.order_headers A
    Join a_bkorders.order_details using (order_id)
	Group by OrdYr, OrdM, order_id with Rollup) tbl
--------------

+-------------+------------+-------------+-----------+----------------+
| Year        | Month      | Order_ID    | AmntDue   | NumbBooksPurch |
+-------------+------------+-------------+-----------+----------------+
| 2011        | 7          | 2045        |     35.99 |              1 |
| 2011        | 7          | 2200        |    542.60 |             15 |
| 2011        | 7          | 21841       |   1250.00 |             50 |
| 2011        | 7          | 21850       |     55.49 |              2 |
| 2011        | 7          | Month Total |   1884.08 |             68 |
| 2011        | 9          | 22909       |    225.00 |              5 |
| 2011        | 9          | 22910       |    424.95 |             10 |
| 2011        | 9          | 32997       |    841.30 |             25 |
| 2011        | 9          | 32998       |     60.00 |              3 |
| 2011        | 9          | 41005       |    170.90 |              6 |
| 2011        | 9          | 41006       |    429.50 |             10 |
| 2011        | 9          | 42899       |    135.95 |              6 |
| 2011        | 9          | Month Total |   2287.60 |             65 |
| 2011        | 10         | 21254       |    859.50 |             20 |
| 2011        | 10         | 21255       |    564.95 |             12 |
| 2011        | 10         | 21261       |   9742.50 |            250 |
| 2011        | 10         | 32905       |     58.00 |              1 |
| 2011        | 10         | Month Total |  11224.95 |            283 |
| 2011        | Year Total | ........... |  15396.63 |            416 |
| 2012        | 1          | 21411       |   1250.00 |             50 |
| 2012        | 1          | 21420       |   1800.00 |             60 |
| 2012        | 1          | 21442       |   2585.50 |             90 |
| 2012        | 1          | 21483       |    137.45 |              4 |
| 2012        | 1          | 21491       |    123.95 |              3 |
| 2012        | 1          | 21552       |     99.98 |              2 |
| 2012        | 1          | 32900       |   1625.00 |            145 |
| 2012        | 1          | 32901       |   2450.00 |             50 |
| 2012        | 1          | 32902       |   6794.00 |            149 |
| 2012        | 1          | Month Total |  16865.88 |            553 |
| 2012        | 2          | 1553        |   6900.00 |            300 |
| 2012        | 2          | 1555        |    564.95 |             12 |
| 2012        | 2          | 1561        |    308.70 |              7 |
| 2012        | 2          | 1562        |    299.70 |              8 |
| 2012        | 2          | 30814       |    276.00 |             23 |
| 2012        | 2          | 30815       |   3875.00 |            155 |
| 2012        | 2          | 32903       |     58.00 |              1 |
| 2012        | 2          | 32904       |   2454.26 |            454 |
| 2012        | 2          | Month Total |  14736.61 |            960 |
| 2012        | 3          | 30816       |   1250.00 |             50 |
| 2012        | 3          | 30820       |   1250.00 |             50 |
| 2012        | 3          | 30821       |     21.90 |              2 |
| 2012        | 3          | 30822       |    499.50 |             10 |
| 2012        | 3          | Month Total |   3021.40 |            112 |
| 2012        | 4          | 1564        |   4745.00 |            150 |
| 2012        | 4          | 1800        |    221.70 |              6 |
| 2012        | 4          | 1801        |     50.90 |              3 |
| 2012        | 4          | 2001        |   1250.00 |             50 |
| 2012        | 4          | 2002        |    219.00 |             20 |
| 2012        | 4          | 2003        |     24.00 |              2 |
| 2012        | 4          | 30824       |   1300.00 |             30 |
| 2012        | 4          | 30825       |    181.96 |              4 |
| 2012        | 4          | 30826       |    560.00 |             16 |
| 2012        | 4          | 30833       |   1250.00 |             50 |
| 2012        | 4          | 30834       |     49.95 |              1 |
| 2012        | 4          | Month Total |   9852.51 |            332 |
| 2012        | 5          | 1710        |   4503.51 |             99 |
| 2012        | 5          | 1712        |   3015.99 |            100 |
| 2012        | 5          | 1811        |    171.86 |              6 |
| 2012        | 5          | 1812        |     26.99 |              1 |
| 2012        | 5          | 1814        |     45.99 |              1 |
| 2012        | 5          | 1818        |    750.98 |             34 |
| 2012        | 5          | 2004        |     35.00 |              1 |
| 2012        | 5          | 2005        |   1250.00 |             50 |
| 2012        | 5          | 30835       |    273.75 |             25 |
| 2012        | 5          | 30836       |     25.00 |              2 |
| 2012        | 5          | Month Total |  10099.07 |            319 |
| 2012        | 6          | 2012        |   1250.00 |             50 |
| 2012        | 6          | 2013        |     25.00 |              2 |
| 2012        | 6          | 30847       |     24.00 |              2 |
| 2012        | 6          | 30848       |     25.00 |              2 |
| 2012        | 6          | 30849       |   1250.00 |             50 |
| 2012        | 6          | Month Total |   2574.00 |            106 |
| 2012        | 7          | 1045        |     35.99 |              1 |
| 2012        | 7          | 1200        |   1383.90 |             40 |
| 2012        | 7          | 1205        |     27.29 |              1 |
| 2012        | 7          | 1212        |     56.34 |              2 |
| 2012        | 7          | 31840       |     24.00 |              2 |
| 2012        | 7          | 31841       |   1250.00 |             50 |
| 2012        | 7          | 31850       |     40.49 |              1 |
| 2012        | 7          | Month Total |   2818.01 |             97 |
| 2012        | 8          | 1224        |    441.52 |              8 |
| 2012        | 8          | 1253        |     69.00 |              3 |
| 2012        | 8          | 31852       |     40.49 |              1 |
| 2012        | 8          | 31853       |    999.00 |             30 |
| 2012        | 8          | 31855       |     40.49 |              1 |
| 2012        | 8          | 31860       |     40.49 |              1 |
| 2012        | 8          | Month Total |   1630.99 |             44 |
| 2012        | 9          | 1002        |    581.00 |             23 |
| 2012        | 9          | 1003        |    225.00 |              5 |
| 2012        | 9          | 1004        |     36.50 |              2 |
| 2012        | 9          | 1005        |    170.90 |              6 |
| 2012        | 9          | 1006        |    109.50 |             10 |
| 2012        | 9          | 1007        |   1250.00 |             50 |
| 2012        | 9          | 1008        |   2000.00 |             50 |
| 2012        | 9          | 1010        |   1250.00 |             50 |
| 2012        | 9          | 1011        |     21.90 |              2 |
| 2012        | 9          | 1012        |     49.95 |              1 |
| 2012        | 9          | 1027        |   1291.57 |             43 |
| 2012        | 9          | 1028        |    996.68 |             25 |
| 2012        | 9          | 1030        |     40.49 |              1 |
| 2012        | 9          | 1035        |     55.19 |              1 |
| 2012        | 9          | 1039        |     99.90 |              3 |
| 2012        | 9          | 1040        |  21939.98 |            562 |
| 2012        | 9          | 1602        |     50.90 |              3 |
| 2012        | 9          | 1603        |    252.75 |              7 |
| 2012        | 9          | 1604        |    708.75 |             40 |
| 2012        | 9          | 1606        |    474.50 |             15 |
| 2012        | 9          | 1610        |     24.00 |              2 |
| 2012        | 9          | 1615        |     24.00 |              2 |
| 2012        | 9          | 22803       |   2107.45 |             45 |
| 2012        | 9          | 22804       |   2749.50 |            100 |
| 2012        | 9          | 22805       |   1475.60 |             10 |
| 2012        | 9          | 22806       |     25.00 |              1 |
| 2012        | 9          | 22807       |     34.99 |              1 |
| 2012        | 9          | 22808       |     45.00 |              1 |
| 2012        | 9          | 22809       |    225.00 |              5 |
| 2012        | 9          | 22810       |    424.95 |             10 |
| 2012        | 9          | 22811       |    225.00 |              5 |
| 2012        | 9          | 22812       |   2704.50 |            100 |
| 2012        | 9          | 22813       |    395.76 |              9 |
| 2012        | 9          | 31884       |    209.91 |             10 |
| 2012        | 9          | 31885       |   1250.00 |             50 |
| 2012        | 9          | 31889       |    910.80 |             18 |
| 2012        | 9          | 32800       |   1250.00 |             50 |
| 2012        | 9          | 32890       |    165.00 |             11 |
| 2012        | 9          | 32891       |     75.00 |              5 |
| 2012        | 9          | 32892       |     75.00 |              5 |
| 2012        | 9          | 32893       |     55.19 |              1 |
| 2012        | 9          | 32894       |     35.99 |              1 |
| 2012        | 9          | 32895       |     55.19 |              1 |
| 2012        | 9          | 32896       |     35.99 |              1 |
| 2012        | 9          | 32897       |    100.00 |              2 |
| 2012        | 9          | 32898       |     60.00 |              3 |
| 2012        | 9          | 32899       |   1250.00 |             50 |
| 2012        | 9          | Month Total |  47594.28 |           1398 |
| 2012        | 10         | 1563        |     50.90 |              3 |
| 2012        | 10         | 1601        |    800.30 |             21 |
| 2012        | 10         | 1605        |   1057.00 |             32 |
| 2012        | 10         | 1702        |    100.00 |              2 |
| 2012        | 10         | 1705        |  21059.00 |            500 |
| 2012        | 10         | 14873       |    137.45 |              4 |
| 2012        | 10         | 31871       |     99.90 |              3 |
| 2012        | 10         | 31872       |   3000.00 |            100 |
| 2012        | 10         | Month Total |  26304.55 |            665 |
| 2012        | 11         | 5261        |   9742.50 |            250 |
| 2012        | 11         | 5262        |    213.75 |              6 |
| 2012        | 11         | 5321        |   2047.80 |             30 |
| 2012        | 11         | 5328        |   3149.30 |             70 |
| 2012        | 11         | 5345        |   2206.00 |             40 |
| 2012        | 11         | 54883       |    137.45 |              4 |
| 2012        | 11         | Month Total |  17496.80 |            400 |
| 2012        | 12         | 1346        |  29267.00 |            900 |
| 2012        | 12         | 1347        |    237.13 |              6 |
| 2012        | 12         | 1410        |    700.00 |             35 |
| 2012        | 12         | 5483        |    137.45 |              4 |
| 2012        | 12         | 5491        |    123.95 |              3 |
| 2012        | 12         | 5552        |     99.98 |              2 |
| 2012        | 12         | 32907       |    285.40 |             13 |
| 2012        | 12         | 52905       |     58.00 |              1 |
| 2012        | 12         | 52906       |    287.75 |             14 |
| 2012        | 12         | Month Total |  31196.66 |            978 |
| 2012        | Year Total | ........... | 184190.76 |           5964 |
| 2013        | 1          | 5555        |    564.95 |             12 |
| 2013        | 1          | 5561        |    308.70 |              7 |
| 2013        | 1          | 5562        |    299.70 |              8 |
| 2013        | 1          | 52900       |   1625.00 |            145 |
| 2013        | 1          | 52901       |   2450.00 |             50 |
| 2013        | 1          | Month Total |   5248.35 |            222 |
| 2013        | 2          | 18142       |     26.99 |              1 |
| 2013        | 2          | 18144       |     45.99 |              1 |
| 2013        | 2          | 40814       |    276.00 |             23 |
| 2013        | 2          | 40836       |     25.00 |              2 |
| 2013        | 2          | 41811       |    171.86 |              6 |
| 2013        | 2          | 41812       |     26.99 |              1 |
| 2013        | 2          | 41814       |     45.99 |              1 |
| 2013        | 2          | Month Total |    618.82 |             35 |
| 2013        | 3          | 4002        |    581.00 |             23 |
| 2013        | 3          | 4003        |    225.00 |              5 |
| 2013        | 3          | 4007        |   1250.00 |             50 |
| 2013        | 3          | 33001       |    180.00 |              6 |
| 2013        | 3          | 33002       |    237.13 |              6 |
| 2013        | 3          | 33005       |     51.95 |              2 |
| 2013        | 3          | 33006       |     51.95 |              2 |
| 2013        | 3          | 33007       |    161.19 |              4 |
| 2013        | 3          | 33008       |    189.00 |              7 |
| 2013        | 3          | 33009       |    195.00 |              5 |
| 2013        | 3          | 33013       |   6794.00 |            149 |
| 2013        | 3          | 33014       |    519.50 |             20 |
| 2013        | 3          | 33017       |      4.00 |              1 |
| 2013        | 3          | 33022       |    199.95 |              1 |
| 2013        | 3          | 33023       |    460.00 |              5 |
| 2013        | 3          | 33034       |     61.89 |              3 |
| 2013        | 3          | 33035       |    180.00 |              2 |
| 2013        | 3          | 33040       |     51.95 |              2 |
| 2013        | 3          | 41224       |    441.52 |              8 |
| 2013        | 3          | 41840       |     24.00 |              2 |
| 2013        | 3          | 41841       |   1250.00 |             50 |
| 2013        | 3          | 41850       |     40.49 |              1 |
| 2013        | 3          | 41852       |     40.49 |              1 |
| 2013        | 3          | Month Total |  13190.01 |            355 |
| 2013        | 4          | 1256        |     69.00 |              3 |
| 2013        | 4          | 31455       |     40.49 |              1 |
| 2013        | 4          | 31560       |     40.49 |              1 |
| 2013        | 4          | 41853       |    999.00 |             30 |
| 2013        | 4          | Month Total |   1148.98 |             35 |
| 2013        | 5          | 10812       |     49.95 |              1 |
| 2013        | 5          | 22774       |   2749.50 |            100 |
| 2013        | 5          | 23890       |    165.00 |             11 |
| 2013        | 5          | 24345       |   1475.60 |             10 |
| 2013        | 5          | 24802       |   1295.60 |              8 |
| 2013        | 5          | 25803       |   2107.45 |             45 |
| 2013        | 5          | 42331       |     75.00 |              5 |
| 2013        | 5          | 42891       |     15.00 |              1 |
| 2013        | 5          | Month Total |   7933.10 |            181 |
| 2013        | 6          | 1262        |    213.75 |              6 |
| 2013        | 6          | 1302        |     44.99 |              1 |
| 2013        | 6          | 1310        |    100.49 |              3 |
| 2013        | 6          | 1321        |   2047.80 |             30 |
| 2013        | 6          | 1328        |   3149.30 |             70 |
| 2013        | 6          | 1345        |   2206.00 |             40 |
| 2013        | 6          | 32906       |    287.75 |             14 |
| 2013        | 6          | Month Total |   8050.08 |            164 |
| 2013        | 7          | 51840       |     24.00 |              2 |
| 2013        | 7          | 51841       |   1290.49 |             51 |
| 2013        | 7          | 51842       |    402.64 |             16 |
| 2013        | 7          | 51843       |     56.34 |              2 |
| 2013        | 7          | Month Total |   1773.47 |             71 |
| 2013        | 8          | 51833       |   1226.01 |             30 |
| 2013        | 8          | 51850       |     70.00 |              1 |
| 2013        | 8          | 51851       |    148.94 |              3 |
| 2013        | 8          | 51852       |      0.00 |              2 |
| 2013        | 8          | 51853       |   2525.00 |            100 |
| 2013        | 8          | 51854       |    230.55 |             15 |
| 2013        | 8          | 51855       |    181.00 |             11 |
| 2013        | 8          | 51856       |     46.78 |              4 |
| 2013        | 8          | Month Total |   4428.28 |            166 |
| 2013        | 9          | 51845       |   1277.25 |             41 |
| 2013        | 9          | 51846       |    642.68 |             32 |
| 2013        | 9          | 51857       |    185.12 |              5 |
| 2013        | 9          | 51858       |    116.70 |              6 |
| 2013        | 9          | 51859       |    113.94 |              2 |
| 2013        | 9          | 51860       |     55.99 |              1 |
| 2013        | 9          | Month Total |   2391.68 |             87 |
| 2013        | 10         | 51847       |     38.89 |              3 |
| 2013        | 10         | 51848       |    888.00 |             50 |
| 2013        | 10         | 51849       |   2138.00 |            100 |
| 2013        | 10         | 51861       |    177.97 |              3 |
| 2013        | 10         | 51862       |    480.72 |              4 |
| 2013        | 10         | 51863       |    837.90 |             42 |
| 2013        | 10         | 51864       |  12092.85 |            349 |
| 2013        | 10         | Month Total |  16654.33 |            551 |
| 2013        | Year Total | ........... |  61437.10 |           1867 |
| Grand Total | .......... | ........... | 261024.49 |           8247 |
+-------------+------------+-------------+-----------+----------------+
253 rows in set (0.01 sec)

--------------
/*  TASK 04 */
Select coalesce(OrdYr, 'Grand Total') as ''
, 'Yearly Total' as ''
, NumberOrders 
, AmntDue
, NumbBooksPurch
From (
	Select year(order_date) as OrdYr
	, count(order_id) as NumberOrders
	, sum(quantity * order_price) as AmntDue
	, sum(quantity) as NumbBooksPurch
	From a_bkorders.order_headers
    Join a_bkorders.order_details using (order_id)
	Group by OrdYr with Rollup) tbl
--------------

+-------------+--------------+--------------+-----------+----------------+
|             |              | NumberOrders | AmntDue   | NumbBooksPurch |
+-------------+--------------+--------------+-----------+----------------+
| 2011        | Yearly Total |           30 |  15396.63 |            416 |
| 2012        | Yearly Total |          228 | 184190.76 |           5964 |
| 2013        | Yearly Total |          150 |  61437.10 |           1867 |
| Grand Total | Yearly Total |          408 | 261024.49 |           8247 |
+-------------+--------------+--------------+-----------+----------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 05 */
Select coalesce(author_id, 'All Authors') as AuthorID
, coalesce(book_id, 'All books') as BookID
, coalesce(tq, 0) as TotalQuantity
, coalesce(ts, 'No Sales') as TotalSales
From (
	Select author_id
	, book_id
	, sum(quantity) as tq
	, sum(order_price * quantity) as ts
	From a_bkinfo.book_authors
	Join a_bkinfo.books using (book_id)
	Left Join a_bkorders.order_details using (book_id)
	Where author_sequence = 1
	Group by author_id, book_id with Rollup) tbl
--------------

+-------------+-----------+---------------+------------+
| AuthorID    | BookID    | TotalQuantity | TotalSales |
+-------------+-----------+---------------+------------+
| A0110       | 1142      |           259 | 8895.60    |
| A0110       | All books |           259 | 8895.60    |
| A5748       | 1278      |             1 | 48.00      |
| A5748       | All books |             1 | 48.00      |
| B1112       | 2006      |            42 | 866.95     |
| B1112       | 2007      |            43 | 1526.98    |
| B1112       | All books |            85 | 2393.93    |
| B1144       | 1622      |             0 | No Sales   |
| B1144       | All books |             0 | No Sales   |
| B1244       | 1623      |             0 | No Sales   |
| B1244       | All books |             0 | No Sales   |
| B2010       | 1102      |             4 | 199.96     |
| B2010       | 1689      |            13 | 717.47     |
| B2010       | All books |            17 | 917.43     |
| B2078       | 2005      |            20 | 900.00     |
| B2078       | All books |            20 | 900.00     |
| C0030       | 1106      |           134 | 3867.50    |
| C0030       | 1107      |           103 | 2301.50    |
| C0030       | 1161      |           164 | 4765.00    |
| C0030       | 1162      |           188 | 6064.09    |
| C0030       | All books |           589 | 16998.09   |
| C0844       | 1401      |           541 | 29966.00   |
| C0844       | All books |           541 | 29966.00   |
| C5820       | 1478      |             5 | 225.00     |
| C5820       | All books |             5 | 225.00     |
| C8794       | 1948      |            12 | 491.28     |
| C8794       | All books |            12 | 491.28     |
| D0030       | 1109      |            53 | 1840.80    |
| D0030       | 1128      |           769 | 29561.84   |
| D0030       | All books |           822 | 31402.64   |
| D2110       | 1301      |            45 | 2047.50    |
| D2110       | 1304      |           116 | 5445.84    |
| D2110       | All books |           161 | 7493.34    |
| D3040       | 1101      |            44 | 2504.16    |
| D3040       | All books |            44 | 2504.16    |
| D6290       | 2025      |           560 | 21840.00   |
| D6290       | All books |           560 | 21840.00   |
| D8902       | 1182      |           142 | 6388.60    |
| D8902       | All books |           142 | 6388.60    |
| D8956       | 1175      |             3 | 114.89     |
| D8956       | 1184      |             1 | 49.99      |
| D8956       | All books |             4 | 164.88     |
| G4040       | 2009      |            40 | 1332.22    |
| G4040       | All books |            40 | 1332.22    |
| G4748       | 1537      |            73 | 1699.69    |
| G4748       | All books |            73 | 1699.69    |
| G5050       | 1200      |            21 | 344.30     |
| G5050       | 1234      |             0 | No Sales   |
| G5050       | 1774      |             1 | 14.67      |
| G5050       | All books |            22 | 358.97     |
| G8495       | 1545      |             7 | 95.80      |
| G8495       | All books |             7 | 95.80      |
| H0187       | 1457      |            10 | 539.90     |
| H0187       | All books |            10 | 539.90     |
| H0202       | 1185      |             1 | 49.99      |
| H0202       | All books |             1 | 49.99      |
| H2987       | 2001      |           296 | 11755.57   |
| H2987       | All books |           296 | 11755.57   |
| H3145       | 1627      |             5 | 680.67     |
| H3145       | 1628      |            21 | 690.55     |
| H3145       | 1629      |            54 | 1077.30    |
| H3145       | All books |            80 | 2448.52    |
| I5110       | 2031      |             0 | No Sales   |
| I5110       | 2032      |             5 | 233.96     |
| I5110       | All books |             5 | 233.96     |
| J8845       | 1541      |             9 | 105.90     |
| J8845       | 1542      |             1 | 16.99      |
| J8845       | All books |            10 | 122.89     |
| K7620       | 1425      |            53 | 1486.58    |
| K7620       | 1448      |           992 | 25441.00   |
| K7620       | 1978      |            25 | 2372.00    |
| K7620       | All books |          1070 | 29299.58   |
| L0140       | 1108      |           942 | 28410.30   |
| L0140       | All books |           942 | 28410.30   |
| L0245       | 1894      |            24 | 844.48     |
| L0245       | All books |            24 | 844.48     |
| L0453       | 1188      |             1 | 49.99      |
| L0453       | All books |             1 | 49.99      |
| M0024       | 1609      |             4 | 75.80      |
| M0024       | All books |             4 | 75.80      |
| M0053       | 1105      |            80 | 4412.00    |
| M0053       | 1110      |             4 | 200.00     |
| M0053       | 1269      |             3 | 186.73     |
| M0053       | All books |            87 | 4798.73    |
| M0157       | 1678      |            10 | 499.90     |
| M0157       | All books |            10 | 499.90     |
| M0295       | 1543      |            50 | 1250.00    |
| M0295       | 1544      |           100 | 1776.00    |
| M0295       | All books |           150 | 3026.00    |
| M2475       | 1624      |             0 | No Sales   |
| M2475       | All books |             0 | No Sales   |
| M3110       | 1302      |             0 | No Sales   |
| M3110       | 1303      |             0 | No Sales   |
| M3110       | All books |             0 | No Sales   |
| M3145       | 1626      |             1 | 19.95      |
| M3145       | All books |             1 | 19.95      |
| M3200       | 1546      |            14 | 145.46     |
| M3200       | All books |            14 | 145.46     |
| M4540       | 2622      |             0 | No Sales   |
| M4540       | 2623      |             0 | No Sales   |
| M4540       | All books |             0 | No Sales   |
| N6457       | 1835      |             1 | 45.99      |
| N6457       | All books |             1 | 45.99      |
| O0345       | 2003      |             0 | No Sales   |
| O0345       | All books |             0 | No Sales   |
| P0500       | 1279      |            12 | 472.38     |
| P0500       | All books |            12 | 472.38     |
| P2308       | 2002      |            27 | 955.00     |
| P2308       | All books |            27 | 955.00     |
| P6030       | 2018      |             2 | 99.98      |
| P6030       | All books |             2 | 99.98      |
| P7477       | 1525      |             0 | No Sales   |
| P7477       | All books |             0 | No Sales   |
| R2040       | 1670      |            60 | 2400.00    |
| R2040       | All books |            60 | 2400.00    |
| R5858       | 1357      |            54 | 1393.60    |
| R5858       | All books |            54 | 1393.60    |
| S0025       | 1104      |           133 | 5985.00    |
| S0025       | All books |           133 | 5985.00    |
| S0205       | 2008      |            98 | 4280.95    |
| S0205       | All books |            98 | 4280.95    |
| S1164       | 1180      |            12 | 556.88     |
| S1164       | All books |            12 | 556.88     |
| S1900       | 1877      |             1 | 45.00      |
| S1900       | All books |             1 | 45.00      |
| S2548       | 1677      |             1 | 70.00      |
| S2548       | All books |             1 | 70.00      |
| S2789       | 2004      |             1 | 49.95      |
| S2789       | All books |             1 | 49.95      |
| S3110       | 1305      |           898 | 5172.50    |
| S3110       | 1306      |            15 | 3751.80    |
| S3110       | All books |           913 | 8924.30    |
| T6789       | 1979      |             1 | 53.99      |
| T6789       | All books |             1 | 53.99      |
| V1144       | 1621      |             0 | No Sales   |
| V1144       | All books |             0 | No Sales   |
| W0030       | 1133      |            18 | 332.10     |
| W0030       | All books |            18 | 332.10     |
| W0078       | 1258      |             6 | 271.94     |
| W0078       | All books |             6 | 271.94     |
| W3145       | 1630      |             0 | No Sales   |
| W3145       | All books |             0 | No Sales   |
| W3433       | 1619      |           110 | 2997.88    |
| W3433       | All books |           110 | 2997.88    |
| W4512       | 2027      |             0 | No Sales   |
| W4512       | All books |             0 | No Sales   |
| W5145       | 1625      |             1 | 4.00       |
| W5145       | All books |             1 | 4.00       |
| All Authors | All books |          7560 | 245375.59  |
+-------------+-----------+---------------+------------+
149 rows in set (0.00 sec)

--------------
/*  TASK 06 */
Select case when author_sequence is null then '_anon' else coalesce(author_id,'All Authors') end as AuthorID
, case when (author_id is null and book_id is null)
or (author_sequence is not null and author_id is not null) then coalesce(book_id, 'All books') end as BookID
, coalesce(tq, 0) as TotalQuantity
, coalesce(ts, 'No Sales') as TotalSales
From (
	Select author_id
	, book_id
	, author_sequence
	, sum(quantity) as tq
	, sum(order_price * quantity) as ts
	From a_bkinfo.authors
	Left Join a_bkinfo.book_authors using (author_id)
	Right Join a_bkinfo.books using (book_id)
	Left Join a_bkorders.order_details using (book_id)
	Where author_sequence = 1
	Or author_sequence is null
	Group by author_id, book_id with Rollup) tbl
--------------

+-------------+-----------+---------------+------------+
| AuthorID    | BookID    | TotalQuantity | TotalSales |
+-------------+-----------+---------------+------------+
| _anon       | NULL      |            22 | 241.78     |
| _anon       | NULL      |           422 | 5119.95    |
| _anon       | NULL      |            24 | 437.76     |
| _anon       | NULL      |             0 | No Sales   |
| _anon       | NULL      |             5 | 90.95      |
| _anon       | NULL      |           203 | 9184.47    |
| _anon       | NULL      |             2 | 49.99      |
| _anon       | NULL      |             9 | 524.00     |
| _anon       | NULL      |             0 | No Sales   |
| _anon       | All books |           687 | 15648.90   |
| A0110       | 1142      |           259 | 8895.60    |
| A0110       | All books |           259 | 8895.60    |
| A5748       | 1278      |             1 | 48.00      |
| A5748       | All books |             1 | 48.00      |
| B1112       | 2006      |            42 | 866.95     |
| B1112       | 2007      |            43 | 1526.98    |
| B1112       | All books |            85 | 2393.93    |
| B1144       | 1622      |             0 | No Sales   |
| B1144       | All books |             0 | No Sales   |
| B1244       | 1623      |             0 | No Sales   |
| B1244       | All books |             0 | No Sales   |
| B2010       | 1102      |             4 | 199.96     |
| B2010       | 1689      |            13 | 717.47     |
| B2010       | All books |            17 | 917.43     |
| B2078       | 2005      |            20 | 900.00     |
| B2078       | All books |            20 | 900.00     |
| C0030       | 1106      |           134 | 3867.50    |
| C0030       | 1107      |           103 | 2301.50    |
| C0030       | 1161      |           164 | 4765.00    |
| C0030       | 1162      |           188 | 6064.09    |
| C0030       | All books |           589 | 16998.09   |
| C0844       | 1401      |           541 | 29966.00   |
| C0844       | All books |           541 | 29966.00   |
| C5820       | 1478      |             5 | 225.00     |
| C5820       | All books |             5 | 225.00     |
| C8794       | 1948      |            12 | 491.28     |
| C8794       | All books |            12 | 491.28     |
| D0030       | 1109      |            53 | 1840.80    |
| D0030       | 1128      |           769 | 29561.84   |
| D0030       | All books |           822 | 31402.64   |
| D2110       | 1301      |            45 | 2047.50    |
| D2110       | 1304      |           116 | 5445.84    |
| D2110       | All books |           161 | 7493.34    |
| D3040       | 1101      |            44 | 2504.16    |
| D3040       | All books |            44 | 2504.16    |
| D6290       | 2025      |           560 | 21840.00   |
| D6290       | All books |           560 | 21840.00   |
| D8902       | 1182      |           142 | 6388.60    |
| D8902       | All books |           142 | 6388.60    |
| D8956       | 1175      |             3 | 114.89     |
| D8956       | 1184      |             1 | 49.99      |
| D8956       | All books |             4 | 164.88     |
| G4040       | 2009      |            40 | 1332.22    |
| G4040       | All books |            40 | 1332.22    |
| G4748       | 1537      |            73 | 1699.69    |
| G4748       | All books |            73 | 1699.69    |
| G5050       | 1200      |            21 | 344.30     |
| G5050       | 1234      |             0 | No Sales   |
| G5050       | 1774      |             1 | 14.67      |
| G5050       | All books |            22 | 358.97     |
| G8495       | 1545      |             7 | 95.80      |
| G8495       | All books |             7 | 95.80      |
| H0187       | 1457      |            10 | 539.90     |
| H0187       | All books |            10 | 539.90     |
| H0202       | 1185      |             1 | 49.99      |
| H0202       | All books |             1 | 49.99      |
| H2987       | 2001      |           296 | 11755.57   |
| H2987       | All books |           296 | 11755.57   |
| H3145       | 1627      |             5 | 680.67     |
| H3145       | 1628      |            21 | 690.55     |
| H3145       | 1629      |            54 | 1077.30    |
| H3145       | All books |            80 | 2448.52    |
| I5110       | 2031      |             0 | No Sales   |
| I5110       | 2032      |             5 | 233.96     |
| I5110       | All books |             5 | 233.96     |
| J8845       | 1541      |             9 | 105.90     |
| J8845       | 1542      |             1 | 16.99      |
| J8845       | All books |            10 | 122.89     |
| K7620       | 1425      |            53 | 1486.58    |
| K7620       | 1448      |           992 | 25441.00   |
| K7620       | 1978      |            25 | 2372.00    |
| K7620       | All books |          1070 | 29299.58   |
| L0140       | 1108      |           942 | 28410.30   |
| L0140       | All books |           942 | 28410.30   |
| L0245       | 1894      |            24 | 844.48     |
| L0245       | All books |            24 | 844.48     |
| L0453       | 1188      |             1 | 49.99      |
| L0453       | All books |             1 | 49.99      |
| M0024       | 1609      |             4 | 75.80      |
| M0024       | All books |             4 | 75.80      |
| M0053       | 1105      |            80 | 4412.00    |
| M0053       | 1110      |             4 | 200.00     |
| M0053       | 1269      |             3 | 186.73     |
| M0053       | All books |            87 | 4798.73    |
| M0157       | 1678      |            10 | 499.90     |
| M0157       | All books |            10 | 499.90     |
| M0295       | 1543      |            50 | 1250.00    |
| M0295       | 1544      |           100 | 1776.00    |
| M0295       | All books |           150 | 3026.00    |
| M2475       | 1624      |             0 | No Sales   |
| M2475       | All books |             0 | No Sales   |
| M3110       | 1302      |             0 | No Sales   |
| M3110       | 1303      |             0 | No Sales   |
| M3110       | All books |             0 | No Sales   |
| M3145       | 1626      |             1 | 19.95      |
| M3145       | All books |             1 | 19.95      |
| M3200       | 1546      |            14 | 145.46     |
| M3200       | All books |            14 | 145.46     |
| M4540       | 2622      |             0 | No Sales   |
| M4540       | 2623      |             0 | No Sales   |
| M4540       | All books |             0 | No Sales   |
| N6457       | 1835      |             1 | 45.99      |
| N6457       | All books |             1 | 45.99      |
| O0345       | 2003      |             0 | No Sales   |
| O0345       | All books |             0 | No Sales   |
| P0500       | 1279      |            12 | 472.38     |
| P0500       | All books |            12 | 472.38     |
| P2308       | 2002      |            27 | 955.00     |
| P2308       | All books |            27 | 955.00     |
| P6030       | 2018      |             2 | 99.98      |
| P6030       | All books |             2 | 99.98      |
| P7477       | 1525      |             0 | No Sales   |
| P7477       | All books |             0 | No Sales   |
| R2040       | 1670      |            60 | 2400.00    |
| R2040       | All books |            60 | 2400.00    |
| R5858       | 1357      |            54 | 1393.60    |
| R5858       | All books |            54 | 1393.60    |
| S0025       | 1104      |           133 | 5985.00    |
| S0025       | All books |           133 | 5985.00    |
| S0205       | 2008      |            98 | 4280.95    |
| S0205       | All books |            98 | 4280.95    |
| S1164       | 1180      |            12 | 556.88     |
| S1164       | All books |            12 | 556.88     |
| S1900       | 1877      |             1 | 45.00      |
| S1900       | All books |             1 | 45.00      |
| S2548       | 1677      |             1 | 70.00      |
| S2548       | All books |             1 | 70.00      |
| S2789       | 2004      |             1 | 49.95      |
| S2789       | All books |             1 | 49.95      |
| S3110       | 1305      |           898 | 5172.50    |
| S3110       | 1306      |            15 | 3751.80    |
| S3110       | All books |           913 | 8924.30    |
| T6789       | 1979      |             1 | 53.99      |
| T6789       | All books |             1 | 53.99      |
| V1144       | 1621      |             0 | No Sales   |
| V1144       | All books |             0 | No Sales   |
| W0030       | 1133      |            18 | 332.10     |
| W0030       | All books |            18 | 332.10     |
| W0078       | 1258      |             6 | 271.94     |
| W0078       | All books |             6 | 271.94     |
| W3145       | 1630      |             0 | No Sales   |
| W3145       | All books |             0 | No Sales   |
| W3433       | 1619      |           110 | 2997.88    |
| W3433       | All books |           110 | 2997.88    |
| W4512       | 2027      |             0 | No Sales   |
| W4512       | All books |             0 | No Sales   |
| W5145       | 1625      |             1 | 4.00       |
| W5145       | All books |             1 | 4.00       |
| All Authors | All books |          8247 | 261024.49  |
+-------------+-----------+---------------+------------+
159 rows in set (0.01 sec)

--------------
	

/*  TASK 07 */
Select book_id as Book_ID
, page_count as Page_count
, (
	Select count(distinct page_count)
	From a_bkinfo.books as books2
	Where books2.page_count >= books1.page_count) as Rank
From a_bkinfo.books as books1
Where page_count is not null
Order by Rank
--------------

+---------+------------+------+
| Book_ID | Page_count | Rank |
+---------+------------+------+
|    1448 |       3192 |    1 |
|    1306 |       2895 |    2 |
|    1979 |       1368 |    3 |
|    1678 |       1002 |    4 |
|    1677 |        982 |    5 |
|    1689 |        980 |    6 |
|    1401 |        976 |    7 |
|    2622 |        956 |    8 |
|    1545 |        944 |    9 |
|    1182 |        918 |   10 |
|    2005 |        894 |   11 |
|    1142 |        879 |   12 |
|    1269 |        848 |   13 |
|    1623 |        828 |   14 |
|    1161 |        780 |   15 |
|    2031 |        750 |   16 |
|    1627 |        732 |   17 |
|    1877 |        708 |   18 |
|    1108 |        680 |   19 |
|    2001 |        675 |   20 |
|    1184 |        650 |   21 |
|    2018 |        650 |   21 |
|    1109 |        650 |   21 |
|    1835 |        634 |   22 |
|    1670 |        608 |   23 |
|    1104 |        604 |   24 |
|    1185 |        595 |   25 |
|    2025 |        572 |   26 |
|    1894 |        548 |   27 |
|    1628 |        544 |   28 |
|    1175 |        538 |   29 |
|    2017 |        528 |   30 |
|    1110 |        520 |   31 |
|    2008 |        503 |   32 |
|    2623 |        501 |   33 |
|    1776 |        500 |   34 |
|    1258 |        500 |   34 |
|    1200 |        488 |   35 |
|    1245 |        488 |   35 |
|    1425 |        468 |   36 |
|    2028 |        464 |   37 |
|    2027 |        464 |   37 |
|    1105 |        450 |   38 |
|    1541 |        448 |   39 |
|    1234 |        416 |   40 |
|    1278 |        408 |   41 |
|    2003 |        402 |   42 |
|    2002 |        402 |   42 |
|    1077 |        401 |   43 |
|    1180 |        400 |   44 |
|    2004 |        399 |   45 |
|    2007 |        391 |   46 |
|    2006 |        390 |   47 |
|    1609 |        376 |   48 |
|    1478 |        368 |   49 |
|    1978 |        360 |   50 |
|    1630 |        352 |   51 |
|    1162 |        350 |   52 |
|    1948 |        346 |   53 |
|    1544 |        336 |   54 |
|    1279 |        336 |   54 |
|    1543 |        327 |   55 |
|    1107 |        325 |   56 |
|    1546 |        304 |   57 |
|    1621 |        304 |   57 |
|    1101 |        300 |   58 |
|    1457 |        300 |   58 |
|    1304 |        300 |   58 |
|    1774 |        288 |   59 |
|    1626 |        280 |   60 |
|    1128 |        275 |   61 |
|    1622 |        265 |   62 |
|    1542 |        256 |   63 |
|    1102 |        250 |   64 |
|    2032 |        250 |   64 |
|    1106 |        250 |   64 |
|    1357 |        240 |   65 |
|    1525 |        213 |   66 |
|    1629 |        160 |   67 |
|    1619 |        158 |   68 |
|    2009 |        150 |   69 |
|    1133 |        125 |   70 |
|    1103 |        125 |   70 |
|    1483 |        125 |   70 |
|    1188 |        105 |   71 |
|    1305 |        100 |   72 |
|    1199 |         98 |   73 |
|    1537 |         68 |   74 |
|    1625 |         64 |   75 |
|    1624 |          9 |   76 |
|    2029 |          5 |   77 |
|    1301 |          0 |   78 |
+---------+------------+------+
92 rows in set (0.01 sec)

--------------
-- test
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
set @bucket := 50
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
set @rank := 0
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
Select book_id, page_count, Rank
From (
	select
	book_id, page_count
	, case when @bucket < page_count then @rank := @rank + 1
	else @rank:=1
	end as Rank
	, case when @bucket < page_count then @bucket := @bucket + 50
	else @bucket:= @bucket
	end as bk
	From (
		Select book_id, page_count
		From a_bkinfo.books
		order by page_count) as tb1	
	) tb2
--------------

+---------+------------+------+
| book_id | page_count | Rank |
+---------+------------+------+
|    1302 |       NULL |    1 |
|    1303 |       NULL |    1 |
|    1301 |          0 |    1 |
|    2029 |          5 |    1 |
|    1624 |          9 |    1 |
|    1625 |         64 |    2 |
|    1537 |         68 |    1 |
|    1199 |         98 |    1 |
|    1305 |        100 |    1 |
|    1188 |        105 |    2 |
|    1133 |        125 |    1 |
|    1483 |        125 |    1 |
|    1103 |        125 |    1 |
|    2009 |        150 |    1 |
|    1619 |        158 |    2 |
|    1629 |        160 |    1 |
|    1525 |        213 |    2 |
|    1357 |        240 |    1 |
|    1106 |        250 |    1 |
|    1102 |        250 |    1 |
|    2032 |        250 |    1 |
|    1542 |        256 |    2 |
|    1622 |        265 |    1 |
|    1128 |        275 |    1 |
|    1626 |        280 |    1 |
|    1774 |        288 |    1 |
|    1304 |        300 |    1 |
|    1457 |        300 |    1 |
|    1101 |        300 |    1 |
|    1546 |        304 |    2 |
|    1621 |        304 |    1 |
|    1107 |        325 |    1 |
|    1543 |        327 |    1 |
|    1279 |        336 |    1 |
|    1544 |        336 |    1 |
|    1948 |        346 |    1 |
|    1162 |        350 |    1 |
|    1630 |        352 |    2 |
|    1978 |        360 |    1 |
|    1478 |        368 |    1 |
|    1609 |        376 |    1 |
|    2006 |        390 |    1 |
|    2007 |        391 |    1 |
|    2004 |        399 |    1 |
|    1180 |        400 |    1 |
|    1077 |        401 |    2 |
|    2003 |        402 |    1 |
|    2002 |        402 |    1 |
|    1278 |        408 |    1 |
|    1234 |        416 |    1 |
|    1541 |        448 |    1 |
|    1105 |        450 |    1 |
|    2028 |        464 |    2 |
|    2027 |        464 |    1 |
|    1425 |        468 |    1 |
|    1245 |        488 |    1 |
|    1200 |        488 |    1 |
|    1776 |        500 |    1 |
|    1258 |        500 |    1 |
|    2623 |        501 |    2 |
|    2008 |        503 |    1 |
|    1110 |        520 |    1 |
|    2017 |        528 |    1 |
|    1175 |        538 |    1 |
|    1628 |        544 |    1 |
|    1894 |        548 |    1 |
|    2025 |        572 |    2 |
|    1185 |        595 |    1 |
|    1104 |        604 |    2 |
|    1670 |        608 |    1 |
|    1835 |        634 |    1 |
|    2018 |        650 |    1 |
|    1109 |        650 |    1 |
|    1184 |        650 |    1 |
|    2001 |        675 |    2 |
|    1108 |        680 |    1 |
|    1877 |        708 |    2 |
|    1627 |        732 |    1 |
|    2031 |        750 |    1 |
|    1161 |        780 |    2 |
|    1623 |        828 |    3 |
|    1269 |        848 |    1 |
|    1142 |        879 |    2 |
|    2005 |        894 |    1 |
|    1182 |        918 |    2 |
|    1545 |        944 |    1 |
|    2622 |        956 |    2 |
|    1401 |        976 |    1 |
|    1689 |        980 |    1 |
|    1677 |        982 |    1 |
|    1678 |       1002 |    2 |
|    1979 |       1368 |    3 |
|    1306 |       2895 |    4 |
|    1448 |       3192 |    5 |
+---------+------------+------+
94 rows in set (0.00 sec)

--------------
/*  TASK 08 */
Select Publ_ID, left(title,25) as Title, books1.page_count as Page_Count
, (
	Select count(distinct page_count)
	from a_bkinfo.books as books2
	Where books2.page_count <= books1.page_count
	and books2.publ_id = books1.publ_id
	and page_count > 0
	) as Rank
From a_bkinfo.books as books1
where page_count is not null
and page_count > 0
Order by publ_id, Rank
--------------

+---------+---------------------------+------------+------+
| Publ_ID | Title                     | Page_Count | Rank |
+---------+---------------------------+------------+------+
|    NULL | SQL is Fun                |         98 |    0 |
|    9000 | Practical Standards for V |        250 |    1 |
|    9000 | Programming SQL Server wi |        300 |    2 |
|    9000 | T_SQL Programming (Inside |        390 |    3 |
|    9000 | T_SQL Querying (Inside se |        391 |    4 |
|    9000 | .Net Development for Micr |        500 |    5 |
|    9000 | Applied .NET Framework Pr |        608 |    6 |
|    9000 | Programming Visual Basic  |        980 |    7 |
|    9020 | Bird Sense                |        265 |    1 |
|    9020 | The Unfeathered Bird      |        304 |    2 |
|    9021 | Outstanding Mosses and Li |          9 |    1 |
|    9021 | Winter Weed Finder: A Gui |         64 |    2 |
|    9021 | The Great Agnostic: Rober |        256 |    3 |
|    9021 | Bark: A Field Guide to Tr |        280 |    4 |
|    9021 | Hornworts and Liverworts  |        501 |    5 |
|    9021 | Lichens of North America  |        828 |    6 |
|    9021 | Outstanding Bryophytes    |        956 |    7 |
|    9022 | The Leafcutter Ants: Civi |        160 |    1 |
|    9022 | The Social Conquest of Ea |        352 |    2 |
|    9022 | The Ants                  |        732 |    3 |
|    9023 | Freethinkers: A History o |        448 |    1 |
|    9024 | Ties That Bind:The Story  |        327 |    1 |
|    9024 | The House on Diamond Hill |        336 |    2 |
|    9030 | The Forgotten Bird Strike |          5 |    1 |
|    9030 | Oracle and the rest of th |        250 |    2 |
|    9030 | SQL Server 2005 Stored Pr |        399 |    3 |
|    9030 | SQL Server 2005 A Beginne |        402 |    4 |
|    9030 | SQL Server 2005 Developer |        402 |    4 |
|    9030 | Oracle SQL Fundamentals I |        572 |    5 |
|    9030 | Oracle Database 11g SQL   |        650 |    6 |
|    9102 | Sibley Guide to Bird Life |        604 |    1 |
|    9325 | Journeys Through Flatland |        100 |    1 |
|    9325 | SQL for MySQL Developers  |        105 |    2 |
|    9325 | Temporal Data and the Rel |        275 |    3 |
|    9325 | Stories of Discoveries    |        300 |    4 |
|    9325 | Framework Design Guidelin |        346 |    5 |
|    9325 | Doing Objects in Visual B |        500 |    6 |
|    9325 | Data Binding with Windows |        634 |    7 |
|    9325 | MySQL Developer's Library |        650 |    8 |
|    9325 | Intro to DB Systems-7th E |        650 |    8 |
|    9325 | Database Systems          |        680 |    9 |
|    9325 | Developer's Guide to SQL  |        894 |   10 |
|    9325 | Visual Studio Tools for O |        976 |   11 |
|    9325 | Windows Forms 2.0 Program |        982 |   12 |
|    9444 | Visual Basic 2008 Recipes |        300 |    1 |
|    9444 | Beginning OO Programming  |        368 |    2 |
|    9444 | Beginning VB 2008 Databas |        408 |    3 |
|    9444 | Mastering Oracle SQL and  |        464 |    4 |
|    9444 | Mastering Oracle Database |        464 |    4 |
|    9444 | SQL Server 2005 T_Sql Rec |        503 |    5 |
|    9444 | Comparative SQL           |        750 |    6 |
|    9444 | Pro .NET 2.0 Windows Form |       1002 |    7 |
|    9444 | Pro VB 2008 and the .NET  |       1368 |    8 |
|    9456 | Selected Poems            |        125 |    1 |
|    9456 | Programming for Poets     |        401 |    2 |
|    9521 | Relational Database Theor |        879 |    1 |
|    9528 | Functional Programming    |        528 |    1 |
|    9561 | Acoustic Communication in |        360 |    1 |
|    9561 | The Singing Life of Birds |        468 |    2 |
|    9561 | Backyard Birdsong Guide:  |       3192 |    3 |
|    9623 | Leaves of Grass           |        125 |    1 |
|    9664 | SQL Server 2005 Express E |        150 |    1 |
|    9664 | Myths of SQL              |       2895 |    2 |
|    9725 | The BedSide Book of Birds |         68 |    1 |
|    9725 | The Oject-Oriented Though |        158 |    2 |
|    9725 | Interface-Oriented Design |        213 |    3 |
|    9725 | Why Birds Sing            |        240 |    4 |
|    9725 | In the Company of Crows a |        376 |    5 |
|    9745 | Programming with XML      |        125 |    1 |
|    9745 | SQL for Smarties          |        250 |    2 |
|    9745 | SQL Puzzles and Answers   |        325 |    3 |
|    9745 | Trees and Hierarchies     |        350 |    4 |
|    9745 | SQL:1999 Relational Langu |        450 |    5 |
|    9745 | Adv SQL:1999 Object_Relat |        520 |    6 |
|    9745 | SQL Programming Style     |        780 |    7 |
|    9745 | Querying XML              |        848 |    8 |
|    9776 | The Johnstown Flood       |        304 |    1 |
|    9776 | Team of Rivals: The Polit |        944 |    2 |
|    9822 | Data-Driven Services with |        336 |    1 |
|    9822 | MySQL in a Nutshell       |        538 |    2 |
|    9822 | Programming Visual Basic  |        548 |    3 |
|    9822 | MySQL Stored Procedures   |        595 |    4 |
|    9822 | Programming SQL Server 20 |        675 |    5 |
|    9822 | High Performance MySQL    |        708 |    6 |
|    9822 | MySQL Cookbook            |        918 |    7 |
|    9825 | MySQL Database Design and |        400 |    1 |
|    9902 | Ever Since Darwin         |        288 |    1 |
|    9902 | Hen's Teeth and Horse's T |        416 |    2 |
|    9902 | The Mismeasure of Man     |        488 |    3 |
|    9902 | A Scientific Approach to  |        488 |    3 |
|    9902 | The Superorganism:The Bea |        544 |    4 |
+---------+---------------------------+------------+------+
91 rows in set (0.00 sec)

--------------
-- how come I can't use Rank in between 1 and 3 in the where clause?
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
/*  TASK 09 */
Select odDate as OrderDate
, o_ID as "3 Day Order Count"
, sum(a2.quantity) as "3 Day Total Quantity"
from (
	Select order_date as odDate, count(order_id) as o_ID
	from a_bkorders.order_headers
	join a_bkorders.order_details using (order_id)
	group by odDate
	) a1
Join (
	Select order_date, quantity
	From a_bkorders.order_headers
	Join a_bkorders.order_details using (order_id)
	) a2
	on a2.order_date between date_add(odDate, interval -1 day)
	and date_add(odDate, interval 1 day)
where month(odDate) = 9 and year(odDate) = 2012
group by odDate
order by odDate
--------------

+------------+-------------------+----------------------+
| OrderDate  | 3 Day Order Count | 3 Day Total Quantity |
+------------+-------------------+----------------------+
| 2012-09-01 |                 1 |                   56 |
| 2012-09-02 |                 3 |                  106 |
| 2012-09-03 |                 1 |                  195 |
| 2012-09-04 |                 2 |                  156 |
| 2012-09-05 |                 2 |                  116 |
| 2012-09-06 |                 2 |                   16 |
| 2012-09-08 |                 3 |                   28 |
| 2012-09-10 |                 9 |                  154 |
| 2012-09-14 |                 5 |                   23 |
| 2012-09-15 |                 3 |                   23 |
| 2012-09-18 |                 6 |                   48 |
| 2012-09-20 |                 4 |                   25 |
| 2012-09-22 |                10 |                   90 |
| 2012-09-23 |                 2 |                   91 |
| 2012-09-24 |                 1 |                   18 |
| 2012-09-25 |                 3 |                   16 |
| 2012-09-28 |                 5 |                  678 |
| 2012-09-29 |                 2 |                  792 |
| 2012-09-30 |                12 |                  214 |
+------------+-------------------+----------------------+
19 rows in set (0.01 sec)

--------------
/*  TASK 10 */
set @startdate = '2012-09-01'
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
set @stopdate = '2012-09-30'
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
select a2.theDate as OrderDate
, coalesce(QO, 0) as QuantityOrdered
, coalesce(TS, 0.00) as TotalSales
from (
	Select theDate
	from
(
	select adddate(@startdate, numvalue) as theDate
	from
	( select b1.val + b2.val + b4.val + b8.val + b16.val + b32.val
		as numvalue
		from
		( select 0 val union all select 1) b1 cross join
		( select 0 val union all select 2) b2 cross join
		( select 0 val union all select 4) b4 cross join
		( select 0 val union all select 8) b8 cross join
		( select 0 val union all select 16) b16 cross join
		( select 0 val union all select 32) b32
	) as gennum
) calendar
where theDate between @startdate and @stopdate) a2
Left Join (
	Select order_date 
	, sum(quantity) as QO
	, sum(quantity * order_price) as TS
	From a_bkorders.order_headers
	Join a_bkorders.order_details using (order_id)
	Where month(order_date) = 9 and year(order_date) = 2012
	Group by order_date) a1 on a2.theDate=a1.order_date
--------------

+------------+-----------------+------------+
| OrderDate  | QuantityOrdered | TotalSales |
+------------+-----------------+------------+
| 2012-09-01 |              11 |     165.00 |
| 2012-09-02 |              45 |    2107.45 |
| 2012-09-03 |              50 |    1250.00 |
| 2012-09-04 |             100 |    2749.50 |
| 2012-09-05 |               6 |     124.95 |
| 2012-09-06 |              10 |    1475.60 |
| 2012-09-07 |               0 |       0.00 |
| 2012-09-08 |              28 |     806.00 |
| 2012-09-09 |               0 |       0.00 |
| 2012-09-10 |             154 |    4308.40 |
| 2012-09-11 |               0 |       0.00 |
| 2012-09-12 |               0 |       0.00 |
| 2012-09-13 |               0 |       0.00 |
| 2012-09-14 |              18 |     525.40 |
| 2012-09-15 |               5 |     103.19 |
| 2012-09-16 |               0 |       0.00 |
| 2012-09-17 |               0 |       0.00 |
| 2012-09-18 |              48 |    1455.24 |
| 2012-09-19 |               0 |       0.00 |
| 2012-09-20 |              25 |     996.68 |
| 2012-09-21 |               0 |       0.00 |
| 2012-09-22 |              88 |    2726.29 |
| 2012-09-23 |               2 |      59.99 |
| 2012-09-24 |               1 |      45.00 |
| 2012-09-25 |              15 |     649.95 |
| 2012-09-26 |               0 |       0.00 |
| 2012-09-27 |               0 |       0.00 |
| 2012-09-28 |             578 |   22220.38 |
| 2012-09-29 |             100 |    2500.00 |
| 2012-09-30 |             114 |    3325.26 |
+------------+-----------------+------------+
30 rows in set (0.00 sec)

Bye
