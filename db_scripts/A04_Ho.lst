--------------
-- Thuong Ho
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
    /* enable warnings! */

use a_vets
--------------

Query OK, 0 rows affected (0.03 sec)

--------------
/*  TASK 00 */ 
select user(), current_date(), version(), @@sql_mode
--------------

*************************** 1. row ***************************
        user(): t_ho@localhost
current_date(): 2013-09-21
     version(): 5.6.13
    @@sql_mode: STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION
1 row in set (0.02 sec)

--------------
/*  TASK 01 */
SELECT an.cl_id, an.an_id, an.an_name, eh.ex_date, ed.ex_fee
FROM vt_animals an
JOIN vt_exam_headers eh ON an.an_id = eh.an_id 
JOIN vt_exam_details ed ON ed.ex_id = ed.ex_id
WHERE ex_fee >= 100
ORDER BY an.cl_id, an.an_id
--------------

+-------+-------+-----------------+---------------------+--------+
| cl_id | an_id | an_name         | ex_date             | ex_fee |
+-------+-------+-----------------+---------------------+--------+
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 275.00 |
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 150.00 |
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 275.00 |
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 222.00 |
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 109.00 |
|   411 | 15401 | Pinkie          | 2013-06-06 10:30:00 | 155.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 275.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 150.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 275.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 222.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 109.00 |
|   411 | 19845 | Pinkie          | 2013-03-22 09:00:00 | 155.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 275.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 150.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 275.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 222.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 109.00 |
|   411 | 21001 | Yoggie          | 2013-02-23 10:30:00 | 155.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 275.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 150.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 275.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 222.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 109.00 |
|   411 | 21003 | Calvin Coolidge | 2013-03-26 09:30:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2013-02-03 14:30:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2013-03-23 12:15:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2012-11-16 09:15:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2012-11-06 10:45:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2012-12-03 14:30:00 | 155.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 150.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 275.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 222.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 109.00 |
|  1825 | 16002 | Fritz           | 2013-01-02 15:30:00 | 155.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 150.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 222.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 109.00 |
|  1825 | 16003 | Ursula          | 2013-05-23 08:30:00 | 155.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 150.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 222.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 109.00 |
|  1825 | 16003 | Ursula          | 2013-05-01 16:30:00 | 155.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 150.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 222.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 109.00 |
|  1825 | 16003 | Ursula          | 2013-04-01 16:30:00 | 155.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 150.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 275.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 222.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 109.00 |
|  1825 | 16003 | Ursula          | 2013-06-10 10:30:00 | 155.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 275.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 150.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 275.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 222.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 109.00 |
|  1825 | 21005 | Koshka          | 2013-03-31 13:00:00 | 155.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 275.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 150.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 275.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 222.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 109.00 |
|  3560 | 12035 | Mr Peanut       | 2013-01-02 16:30:00 | 155.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 150.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 222.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 109.00 |
|  5699 | 15001 | Big Mike        | 2013-01-02 13:00:00 | 155.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 150.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 222.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 109.00 |
|  5699 | 15001 | Big Mike        | 2013-02-09 09:00:00 | 155.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 150.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 275.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 222.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 109.00 |
|  5699 | 15001 | Big Mike        | 2013-04-22 09:00:00 | 155.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 275.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 150.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 275.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 222.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 109.00 |
|  5699 | 15002 | George          | 2013-01-02 13:00:00 | 155.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 275.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 150.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 275.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 222.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 109.00 |
|  5699 | 15002 | George          | 2013-06-10 10:45:00 | 155.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 275.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 150.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 275.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 222.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 109.00 |
|  5699 | 17002 | Fritzchen       | 2012-10-10 09:15:00 | 155.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 150.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 222.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 109.00 |
|  5699 | 17025 | 25              | 2013-04-30 14:30:00 | 155.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 275.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 150.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 275.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 222.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 109.00 |
|  5699 | 17025 | 25              | 2012-11-07 10:45:00 | 155.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 150.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 222.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 109.00 |
|  5699 | 17025 | 25              | 2013-02-03 14:30:00 | 155.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 150.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 222.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 109.00 |
|  5699 | 17025 | 25              | 2013-03-06 10:45:00 | 155.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 150.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 275.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 222.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 109.00 |
|  5699 | 17025 | 25              | 2013-04-29 14:30:00 | 155.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 275.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 150.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 275.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 222.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 109.00 |
|  7152 | 17026 | 3P#_26          | 2013-03-21 10:45:00 | 155.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 275.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 150.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 275.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 222.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 109.00 |
|  7152 | 17026 | 3P#_26          | 2012-12-22 10:45:00 | 155.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 150.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 222.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 109.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-27 10:45:00 | 155.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 150.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 222.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 109.00 |
|  7152 | 17027 | 3P#_25          | 2012-12-24 10:45:00 | 155.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 150.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 275.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 222.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 109.00 |
|  7152 | 17027 | 3P#_25          | 2013-03-06 10:30:00 | 155.00 |
+-------+-------+-----------------+---------------------+--------+
192 rows in set (0.00 sec)

--------------
/*  TASK 02 */
SELECT E.ex_id, S.srv_id, S.srv_desc, S.srv_list_price, E.ex_fee
FROM vt_services S
JOIN vt_exam_details E ON S.srv_id = E.srv_id 
WHERE E.ex_fee BETWEEN 30 AND 60
ORDER BY S.srv_id
--------------

+-------+--------+----------------------------+----------------+--------+
| ex_id | srv_id | srv_desc                   | srv_list_price | ex_fee |
+-------+--------+----------------------------+----------------+--------+
|  3390 |    101 | Dental Cleaning-Canine     |          50.00 |  50.00 |
|  1998 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3101 |    104 | Routine Exam-Reptile       |          60.00 |  60.00 |
|  3102 |    104 | Routine Exam-Reptile       |          60.00 |  60.00 |
|  3288 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3306 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3494 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3513 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3514 |    104 | Routine Exam-Reptile       |          60.00 |  30.00 |
|  3390 |    105 | Routine Exam-Canine        |          80.00 |  55.00 |
|  3282 |    110 | Dental Cleaning-Other      |         100.00 |  50.00 |
|  3392 |    398 | Followup Exam-Canine       |          35.00 |  30.00 |
|  3105 |    523 | Routine Exam-Small Mammal  |          60.00 |  50.50 |
|  3282 |    523 | Routine Exam-Small Mammal  |          60.00 |  60.00 |
|  3612 |    606 | Tooth extraction Level 2   |          40.00 |  40.00 |
|  3612 |    607 | Tooth extraction Level 3   |          57.00 |  57.00 |
|  3104 |    613 | Hospital stay- short       |          47.00 |  47.00 |
|  3612 |    613 | Hospital stay- short       |          47.00 |  47.00 |
|  1998 |    687 | Vitamin E- Concentrated    |          45.00 |  45.00 |
|  3288 |    687 | Vitamin E- Concentrated    |          45.00 |  45.00 |
|  3306 |    687 | Vitamin E- Concentrated    |          45.00 |  45.00 |
|  3392 |   1003 | Intestinal Parasite Screen |          26.00 |  45.00 |
+-------+--------+----------------------------+----------------+--------+
22 rows in set (0.00 sec)

--------------
/*  TASK 03 */
SELECT D.ex_id, H.ex_date, D.srv_id, D.ex_fee
FROM vt_exam_details D	
JOIN vt_exam_headers H ON D.ex_id = H.ex_id
JOIN vt_animals A ON H.an_id = A.an_id
WHERE A.an_type IN ('hamster', 'capybara', 'porcupine', 'dormouse')
ORDER BY D.srv_id
--------------

+-------+---------------------+--------+--------+
| ex_id | ex_date             | srv_id | ex_fee |
+-------+---------------------+--------+--------+
|  3105 | 2012-10-10 09:15:00 |    110 | 150.00 |
|  3105 | 2012-10-10 09:15:00 |    523 |  50.50 |
|  1999 | 2012-12-03 14:30:00 |    524 |  20.00 |
|  3203 | 2013-02-03 14:30:00 |    524 |  20.00 |
|  1996 | 2012-11-16 09:15:00 |    748 |  29.50 |
|  1997 | 2012-11-06 10:45:00 |    748 |   0.00 |
|  3393 | 2013-03-23 12:15:00 |    748 |  29.50 |
|  3486 | 2013-03-31 13:00:00 |   4601 | 275.00 |
|  3103 | 2013-01-02 15:30:00 |   4601 | 275.00 |
+-------+---------------------+--------+--------+
9 rows in set (0.00 sec)

--------------
/*  TASK 04 */
SELECT an_id, an_name
FROM vt_animals
WHERE an_dob BETWEEN '2002-01-01' AND '2005-12-31'
--------------

+-------+-----------------+
| an_id | an_name         |
+-------+-----------------+
| 11029 | NULL            |
| 15165 | Burgess         |
| 21002 | Edger           |
| 21003 | Calvin Coolidge |
+-------+-----------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 05 */
SELECT DISTINCT S.stf_id, S.stf_name_first, S.stf_name_last
FROM vt_staff S
JOIN vt_exam_headers H ON S.stf_id = H.stf_id
JOIN vt_animals A ON H.an_id = A.an_id
WHERE A.an_type IN ('snake', 'chelonian', 'crocodilian', 'lizard')
--------------

+--------+----------------+---------------+
| stf_id | stf_name_first | stf_name_last |
+--------+----------------+---------------+
|     15 | Eliza          | Dolittle      |
|     25 | Bridgette      | Wilkommen     |
|     29 | Sandy          | Helfen        |
+--------+----------------+---------------+
3 rows in set (0.00 sec)

--------------
/*  TASK 06 */
set @client  = 5699
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
SELECT C.cl_id, concat(C.cl_name_first, ' ', C.cl_name_last) AS 'cl_name', A.an_id, A.an_name, H.ex_date, D.srv_id, D.ex_fee 
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
JOIN vt_exam_headers H ON A.an_id = H.an_id
JOIN vt_exam_details D ON H.ex_id = D.ex_id
WHERE C.cl_id = @client
ORDER BY A.an_id
--------------

+-------+-----------------+-------+-----------+---------------------+--------+--------+
| cl_id | cl_name         | an_id | an_name   | ex_date             | srv_id | ex_fee |
+-------+-----------------+-------+-----------+---------------------+--------+--------+
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-01-02 13:00:00 |    104 |  60.00 |
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-01-02 13:00:00 |    615 |  75.00 |
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-02-09 09:00:00 |    104 |  30.00 |
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-02-09 09:00:00 |   1002 |  25.00 |
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-02-09 09:00:00 |    687 |  45.00 |
|  5699 | Sam Biederbecke | 15001 | Big Mike  | 2013-04-22 09:00:00 |    104 |  30.00 |
|  5699 | Sam Biederbecke | 15002 | George    | 2013-01-02 13:00:00 |    104 |  60.00 |
|  5699 | Sam Biederbecke | 15002 | George    | 2013-06-10 10:45:00 |    104 |  30.00 |
|  5699 | Sam Biederbecke | 15002 | George    | 2013-06-10 10:45:00 |   1002 |  15.00 |
|  5699 | Sam Biederbecke | 15002 | George    | 2013-06-10 10:45:00 |   1003 |  25.00 |
|  5699 | Sam Biederbecke | 17002 | Fritzchen | 2012-10-10 09:15:00 |    523 |  50.50 |
|  5699 | Sam Biederbecke | 17002 | Fritzchen | 2012-10-10 09:15:00 |    110 | 150.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2012-11-07 10:45:00 |    104 |  30.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2012-11-07 10:45:00 |    687 |  45.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2012-11-07 10:45:00 |   1002 |  25.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-02-03 14:30:00 |    341 |  20.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-03-06 10:45:00 |    104 |  30.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-03-06 10:45:00 |    687 |  45.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-03-06 10:45:00 |   1002 |  25.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-04-29 14:30:00 |    341 |  20.00 |
|  5699 | Sam Biederbecke | 17025 | 25        | 2013-04-30 14:30:00 |    341 |  20.00 |
+-------+-----------------+-------+-----------+---------------------+--------+--------+
21 rows in set (0.00 sec)

--------------
set @client  = 25479
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
SELECT C.cl_id, concat(C.cl_name_first, ' ', C.cl_name_last) AS 'cl_name', A.an_id, A.an_name, H.ex_date, D.srv_id, D.ex_fee 
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
JOIN vt_exam_headers H ON A.an_id = H.an_id
JOIN vt_exam_details D ON H.ex_id = D.ex_id
WHERE C.cl_id = @client
ORDER BY A.an_id
--------------

Empty set (0.00 sec)

--------------
/*  TASK 07 */
SELECT DISTINCT C.cl_id, C.cl_name_last
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
WHERE A.an_type = 'cat'
ORDER BY C.cl_id
--------------

+-------+--------------+
| cl_id | cl_name_last |
+-------+--------------+
|  1825 | Harris       |
|  1852 | Dalrymple    |
|  3560 | Monk         |
|  6897 | Drake        |
+-------+--------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 08 */
SELECT DISTINCT C.cl_id, C.cl_name_last
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
WHERE A.an_type IS NOT NULL
XOR A.an_type !='cat'
--------------

+-------+--------------+
| cl_id | cl_name_last |
+-------+--------------+
|  1825 | Harris       |
|  1852 | Dalrymple    |
|  3560 | Monk         |
|  6897 | Drake        |
+-------+--------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 09 */
SELECT DISTINCT C.cl_id, C.cl_name_last
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
WHERE A.an_type IN ('hamster', 'capybara', 'porcupine', 'dormouse')
ORDER BY C.cl_id
--------------

+-------+--------------+
| cl_id | cl_name_last |
+-------+--------------+
|  1825 | Harris       |
|  3560 | Monk         |
|  5699 | Biederbecke  |
+-------+--------------+
3 rows in set (0.00 sec)

--------------
/*  TASK 10 */
SELECT DISTINCT C.cl_id, C.cl_name_last
FROM vt_clients C
JOIN vt_animals A ON C.cl_id = A.cl_id
WHERE A.an_type NOT IN ('hamster', 'capybara', 'porcupine', 'dormouse')
ORDER BY C.cl_id
--------------

+-------+--------------+
| cl_id | cl_name_last |
+-------+--------------+
|   411 | Carter       |
|  1825 | Harris       |
|  1852 | Dalrymple    |
|  3560 | Monk         |
|  4534 | Montgomery   |
|  5699 | Biederbecke  |
|  6897 | Drake        |
|  7152 | Brubeck      |
+-------+--------------+
8 rows in set (0.00 sec)

Bye
